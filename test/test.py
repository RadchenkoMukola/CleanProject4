from transformers import BertTokenizer, BertForSequenceClassification, RobertaForSequenceClassification, RobertaTokenizer
import torch
import os
examples = [
    """
    The issue is particularly tricky in an election year, when President Biden and lawmakers are facing potential blowback from users of the popular app. The app, which says it has 170 million monthly users in the United States, is used for everything from sharing viral dances to political commentary. It’s become knitted into people’s lives, particularly for those who make a living on the platform as content creators. Under the new law, which President Biden signed on April 24, TikTok has nine months, or a year if the president gives it an extension, to find a non-Chinese buyer. If it doesn’t, the law requires U.S. app stores and web hosting services to stop working with it — essentially banning it. At the heart of the case will be lawmakers’ intent to defend the United States from what they and some experts say is a national security threat; they assert that the Chinese government could lean on ByteDance to turn over sensitive TikTok user data or use the app to spread propaganda. But the mandate to sell or block the app could result in changes to TikTok’s content policies and shape what users are able to freely share on the platform, potentially violating their free speech rights, according to legal experts. “These are hugely consequential questions being dealt with in an unprecedented manner,” said Evelyn Douek, an assistant professor at Stanford Law School who has done research on the First Amendment and the internet. “TikTok basically throws the First Amendment sink at this challenge.” TikTok filed its suit in the U.S. Court of Appeals for the District of Columbia Circuit, arguing that selling its U.S. operations was not “commercially, technologically, or legally feasible.” A part of that argument hinges on how TikTok and its competitors are global in nature and content is accessible across country borders, with international videos as part of its appeal.
    """,  # Ліве
    """
    The Federal Aviation Administration said Monday it has opened an investigation into the Boeing Dreamliner after the planemaker said some employees had committed “misconduct” by claiming some tests had been completed. The FAA said it is investigating whether Boeing completed the inspections to confirm adequate bonding and grounding where the wings join the fuselage on certain 787 Dreamliner airplanes “and whether company employees may have falsified aircraft records.” The agency said “at the same time, Boeing is reinspecting all 787 airplanes still within the production system and must also create a plan to address the in-service fleet.” The FAA said it is investigating whether Boeing completed the inspections to confirm adequate bonding and grounding where the wings join the fuselage on certain 787 Dreamliner airplanes. REUTERS Boeing shares closed down about 1% at $178.35 on Monday. Asked for comment, Boeing provided an April 29 email from Scott Stocker, who leads the company’s 787 program, to employees in South Carolina where the 787 is assembled. In the email, Stocker said that an employee saw what appeared to be an irregularity in a required 787 conformance test. Stocker said in the email that after receiving the report, “we quickly reviewed the matter and learned that several people had been violating Company policies by not performing a required test, but recording the work as having been completed.” Stocker said Boeing promptly informed the FAA “about what we learned and are taking swift and serious corrective action with multiple” employees. He added, “our engineering team has assessed that this misconduct did not create an immediate safety of flight issue.” Boeing said in April it expects a slower increase in the production rate and deliveries of its 787 Dreamliner widebody jets as the company wrestles with supplier shortages “on a few key parts.” Sen. Roger Marshall (R-Kan.) holds up a graphic illustrating quality issues with a Boeing 787 planes during a hearing last month. AFP via Getty Images A Boeing quality engineer recently criticized some of the manufacturing practices on the 787 and 777 widebody programs and testified last month before Congress. The Justice Department is conducting a criminal investigation into a Jan. 5 mid-air emergency of a Boeing 737 MAX 9. The National Transportation Safety Board has said four key bolts appeared to be missing from the plane that had been delivered by Boeing months earlier. Boeing has said it believes required documents detailing the removal of the bolts were never created.
    """,  # Праве
    """
    Israel Gaza: Hamas says it accepts ceasefire proposal 6 May 2024 Share Save David Gritten BBC News Share Save Watch: Celebrations in Gaza after Hamas says it accepts ceasefire deal Hamas says it has informed Qatari and Egyptian mediators that it has accepted their proposal for a new Gaza ceasefire and hostage release deal with Israel. \"The ball is now in Israel's court,\" an official in the Palestinian group said. Israeli PM Benjamin Netanyahu said the proposal accepted by Hamas was \"far from Israel's basic requirements\" but negotiations would continue. Earlier Israel carried out air strikes on Rafah after warning Palestinians to evacuate parts of the city. It has long threatened an offensive against Hamas hold-outs in the southern city. Tens of thousands of residents are believed to be affected by the operation and many were seen cramming into vehicles or on to donkey carts on Monday. A Hamas official called the evacuation order for eastern parts of Rafah, which was followed by Israeli air strikes, a \"dangerous escalation\". The basis of the ceasefire deal is a weeks-long pause in fighting and the release of several dozen hostages held by Hamas. On Monday evening, Hamas put out a statement saying its political leader, Ismail Haniyeh, had informed Qatar's prime minister and Egypt's intelligence chief of its \"approval of their proposal regarding a ceasefire agreement\". A senior Palestinian official familiar with the proposal told the BBC that Hamas had agreed to end \"hostile activity forever\" if the conditions were met. That phrase hinted that Hamas might be contemplating the end of its armed struggle, although no further details were provided. It would come at the conclusion of a two-phase ceasefire deal, with each phase lasting 42 days. The first phase would include the release of the female Israeli soldiers being held hostage, each in exchange for 50 Palestinian prisoners in Israeli jails, including some who are serving life sentences. During this period, Israeli troops would remain within Gaza. But within 11 days of the ceasefire coming into force, Israel would begin dismantling its military facilities in the centre of the territory and would withdraw from Salah al-Din Road, which is the main north-south route, and the coastal road. After 11 days, displaced Palestinians would be allowed to return to the north. Reuters Both Hamas and Israel have been under pressure to accept a new ceasefire and hostage deal The second phase would conclude with a \"sustainable long period of calm\" and the complete lifting of the blockade of Gaza, according to the official. \"The ball is now in the court of [Israel], whether it will agree to the ceasefire agreement or obstruct it,\" a senior Hamas official told AFP news agency. The were celebrations in Gaza as news of the Hamas statement spread. But an unnamed Israeli official swiftly told Reuters news agency that the proposal Hamas had accepted was a \"softened\" version of an Egyptian proposal which included \"far-reaching\" conclusions that Israel could not accept. \"This would appear to be a ruse intended to make Israel look like the side refusing a deal,\" the official said. Later, Prime Minister Netanyahu's office said in a statement: \"Even though the Hamas proposal is far from Israel's basic requirements, Israel will send a delegation of mediators to exhaust the possibility of reaching an agreement under conditions acceptable to Israel.\" At the same time, Israel's war cabinet had decided to continue the Rafah operation \"to exert military pressure on Hamas to advance our war aims: the release of our hostages, destroy Hamas's military and governing capabilities and ensure that Gaza does not pose a threat to Israel in the future\", it added. The statement came at the same time as the Israeli military announced it was striking Hamas targets in eastern Rafah. Watch: Gazans ask 'where will we go now?' after Rafah evacuation orders US state department spokesman Matthew Miller told reporters that the US - which is attempting to broker a deal along with Qatar and Egypt - was reviewing Hamas's response and \"discussing it with our partners\". \"We continue to believe that a hostage deal is in the best interests of the Israeli people. It's in the best interests of the Palestinian people,\" he added. \"It would bring an immediate ceasefire. It would allow increased movement of humanitarian assistance and so we're going to continue to work to try to reach one.\" The war began when Hamas gunmen stormed into southern Israel on 7 October, killing about 1,200 people and seizing more than 250 hostages. More than 34,700 people have been killed in Gaza during the ensuing Israeli military campaign, according to the territory's Hamas-run health ministry. A deal agreed in November saw Hamas release 105 hostages in return for a week-long ceasefire and some 240 Palestinian prisoners in Israeli jails.
    """,
    """Russian President Vladimir Putin has expressed his readiness for direct peace talks with Ukraine, although no specific plans for the talks have been set. According to a Kremlin spokesman, dialogue may be possible if Ukraine removes certain “obstacles,” but Moscow has refused to support Kyiv’s proposal to extend the Easter truce. Ukrainian President Volodymyr Zelensky has reaffirmed his readiness for talks and called for an end to attacks on civilian infrastructure, arguing that Ukraine is not obstructing the talks. Both leaders have expressed greater readiness for peace efforts, but tensions remain over Russia’s continued maximalist conditions, including demilitarization of Ukraine and recognition of annexed territories"""
]

# Завантажити токенізатор і модель (замінити шлях на свій)
#tokenizer = BertTokenizer.from_pretrained("BERT_bias_1085_each")
#model = BertForSequenceClassification.from_pretrained("BERT_bias_1085_each")
os.chdir("..")
model = RobertaForSequenceClassification.from_pretrained("RoBERTa_bias_1085_each")
tokenizer = RobertaTokenizer.from_pretrained("RoBERTa_bias_1085_each")

# Пристрій
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
model.to(device)

# Вхідні тексти
inputs = tokenizer(examples, padding=True, truncation=True, return_tensors="pt").to(device)

# Прогноз
with torch.no_grad():
    outputs = model(**inputs)
    predictions = torch.argmax(outputs.logits, dim=-1)
    probs = torch.nn.functional.softmax(outputs.logits, dim=-1)

# Мапінг індексів на мітки
id2label = {0: "left", 1: "neutral", 2: "right"}

# Вивід результатів
for text, pred in zip(examples, predictions):
    print(f"Text: {text}\nPredicted: {id2label[pred.item()]}\n")

print(probs)
